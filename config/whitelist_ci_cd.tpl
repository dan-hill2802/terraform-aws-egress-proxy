# Centos / EPEL
mirrors.coreix.net
mirror.centos.org
mirror.bytemark.co.uk
mirrors.ukfast.co.uk

# Docker
download.docker.com
auth.docker.io
registry-1.docker.io
production.cloudflare.docker.com
index.docker.io
quay.io
cdn.quay.io
cdn01.quay.io
cdn02.quay.io
quayio-production-s3.s3.amazonaws.com

# Oracle JDK
download.oracle.com
edelivery.oracle.com

# Apache Maven, TomCat
archive.apache.org

# Python Package Index
pypi.python.org
pypi.org
files.pythonhosted.org

# Node.js & Yarn
registry.yarnpkg.com
yarnpkg.com
classic.yarnpkg.com
registry.npmjs.org

# OS install & updates
cdn-fastly.deb.debian.org
dl-cdn.alpinelinux.org

# EPEL repository configuration files
dl.fedoraproject.org
mirrors.fedoraproject.org
download.fedoraproject.org

# GitHub.com
api.github.com
github.com
codeload.github.com
github-releases.githubusercontent.com

# Allow yum to contact the packages and repo URL's via proxy
packages.eu-west-2.amazonaws.com
repo.eu-west-2.amazonaws.com
amazonlinux.eu-west-2.amazonaws.com

# AWS Cognito
.auth.eu-west-2.amazoncognito.com

# Terraform state
.s3.eu-west-1.amazonaws.com
s3-eu-west-1.amazonaws.com
dynamodb.eu-west-1.amazonaws.com

# AWS APIs without VPC endpoints
batch.eu-west-2.amazonaws.com
cloudhsmv2.eu-west-2.amazonaws.com
cognito-idp.eu-west-2.amazonaws.com
firehose.eu-west-2.amazonaws.com
guardduty.eu-west-2.amazonaws.com
lambda.eu-west-2.amazonaws.com
ram.eu-west-2.amazonaws.com
route53resolver.eu-west-2.amazonaws.com
securityhub.eu-west-2.amazonaws.com
servicediscovery.eu-west-2.amazonaws.com
waf-regional.eu-west-2.amazonaws.com

# CloudFront requires its ACM certificate to be hosted in N. Virginia (see https://docs.aws.amazon.com/acm/latest/userguide/acm-regions.html)
acm.us-east-1.amazonaws.com

# Route 53 DNS Query logging requires the log groups to be hosted in the US East
(N. Virginia) Region (see https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/query-logs.html#query-logs-configuring)
logs.us-east-1.amazonaws.com

# AWS region-specific services - N. Virginia (AWS Config)
config.us-east-1.amazonaws.com
ec2.us-east-1.amazonaws.com
events.us-east-1.amazonaws.com
guardduty.us-east-1.amazonaws.com
securityhub.us-east-1.amazonaws.com
sns.us-east-1.amazonaws.com
sts.us-east-1.amazonaws.com

# AWS region-specific services - Ohio (AWS Config)
config.us-east-2.amazonaws.com
ec2.us-east-2.amazonaws.com
events.us-east-2.amazonaws.com
guardduty.us-east-2.amazonaws.com
securityhub.us-east-2.amazonaws.com
sns.us-east-2.amazonaws.com
sts.us-east-2.amazonaws.com

# AWS region-specific services - California (AWS Config)
config.us-west-1.amazonaws.com
ec2.us-west-1.amazonaws.com
events.us-west-1.amazonaws.com
guardduty.us-west-1.amazonaws.com
securityhub.us-west-1.amazonaws.com
sns.us-west-1.amazonaws.com
sts.us-west-1.amazonaws.com

# AWS region-specific services - Oregon (AWS Config)
config.us-west-2.amazonaws.com
ec2.us-west-2.amazonaws.com
events.us-west-2.amazonaws.com
guardduty.us-west-2.amazonaws.com
securityhub.us-west-2.amazonaws.com
sns.us-west-2.amazonaws.com
sts.us-west-2.amazonaws.com

# AWS region-specific services - Mumbai (AWS Config)
config.ap-south-1.amazonaws.com
ec2.ap-south-1.amazonaws.com
events.ap-south-1.amazonaws.com
guardduty.ap-south-1.amazonaws.com
securityhub.ap-south-1.amazonaws.com
sns.ap-south-1.amazonaws.com
sts.ap-south-1.amazonaws.com

# AWS region-specific services - Seoul (AWS Config)
config.ap-northeast-2.amazonaws.com
ec2.ap-northeast-2.amazonaws.com
events.ap-northeast-2.amazonaws.com
guardduty.ap-northeast-2.amazonaws.com
securityhub.ap-northeast-2.amazonaws.com
sns.ap-northeast-2.amazonaws.com
sts.ap-northeast-2.amazonaws.com

# AWS region-specific services - Singapore (AWS Config)
config.ap-southeast-1.amazonaws.com
ec2.ap-southeast-1.amazonaws.com
events.ap-southeast-1.amazonaws.com
guardduty.ap-southeast-1.amazonaws.com
securityhub.ap-southeast-1.amazonaws.com
sns.ap-southeast-1.amazonaws.com
sts.ap-southeast-1.amazonaws.com

# AWS region-specific services - Sydney (AWS Config)
config.ap-southeast-2.amazonaws.com
ec2.ap-southeast-2.amazonaws.com
events.ap-southeast-2.amazonaws.com
guardduty.ap-southeast-2.amazonaws.com
securityhub.ap-southeast-2.amazonaws.com
sns.ap-southeast-2.amazonaws.com
sts.ap-southeast-2.amazonaws.com

# AWS region-specific services - Tokyo (AWS Config)
config.ap-northeast-1.amazonaws.com
ec2.ap-northeast-1.amazonaws.com
events.ap-northeast-1.amazonaws.com
guardduty.ap-northeast-1.amazonaws.com
securityhub.ap-northeast-1.amazonaws.com
sns.ap-northeast-1.amazonaws.com
sts.ap-northeast-1.amazonaws.com

# AWS region-specific services - Canada (AWS Config)
config.ca-central-1.amazonaws.com
ec2.ca-central-1.amazonaws.com
events.ca-central-1.amazonaws.com
guardduty.ca-central-1.amazonaws.com
securityhub.ca-central-1.amazonaws.com
sns.ca-central-1.amazonaws.com
sts.ca-central-1.amazonaws.com

# AWS region-specific services - Frankfurt (AWS Config)
config.eu-central-1.amazonaws.com
ec2.eu-central-1.amazonaws.com
events.eu-central-1.amazonaws.com
guardduty.eu-central-1.amazonaws.com
securityhub.eu-central-1.amazonaws.com
sns.eu-central-1.amazonaws.com
sts.eu-central-1.amazonaws.com

# AWS region-specific services - Ireland (AWS Config)
config.eu-west-1.amazonaws.com
ec2.eu-west-1.amazonaws.com
events.eu-west-1.amazonaws.com
guardduty.eu-west-1.amazonaws.com
securityhub.eu-west-1.amazonaws.com
sns.eu-west-1.amazonaws.com
sts.eu-west-1.amazonaws.com

# AWS region-specific services - Paris (AWS Config)
config.eu-west-3.amazonaws.com
ec2.eu-west-3.amazonaws.com
events.eu-west-3.amazonaws.com
guardduty.eu-west-3.amazonaws.com
securityhub.eu-west-3.amazonaws.com
sns.eu-west-3.amazonaws.com
sts.eu-west-3.amazonaws.com

# AWS region-specific services - Stockholm (AWS Config)
config.eu-north-1.amazonaws.com
ec2.eu-north-1.amazonaws.com
events.eu-north-1.amazonaws.com
guardduty.eu-north-1.amazonaws.com
securityhub.eu-north-1.amazonaws.com
sns.eu-north-1.amazonaws.com
sts.eu-north-1.amazonaws.com

# AWS region-specific services - Sao Paulo (AWS Config)
config.sa-east-1.amazonaws.com
ec2.sa-east-1.amazonaws.com
events.sa-east-1.amazonaws.com
guardduty.sa-east-1.amazonaws.com
securityhub.sa-east-1.amazonaws.com
sns.sa-east-1.amazonaws.com
sts.sa-east-1.amazonaws.com

# Inspector
inspector.eu-west-2.amazonaws.com

# Hashicorp plugins
releases.hashicorp.com
registry.terraform.io
checkpoint-api.hashicorp.com

# Slack
hooks.slack.com

# Sysdig for ECS AMI
download.sysdig.com

%{ if environment == "management-dev" }
# More rules could be added here for mgmt-dev only
%{ endif }
